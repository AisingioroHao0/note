# I/O系统



## I/O硬件

- I/O端口

  - 数据输入输出寄存器
  - 数据输出寄存器
  - 状态寄存器
  - 控制寄存器

- 总线

  一组线路和通过线路传输信息的严格定义的一个协议

  - PCI总线

    系统总线，链接处理器内存子系统到快速设备

  - 扩展总线链接相对较慢的设备

- 控制器

### 轮询

通过状态寄存器

### 中断

中断控制器硬件提供。

大多数CPU有两条中断请求线：

- 非屏蔽中断

  保留用于注入不可恢复的内存错误等事件

- 可屏蔽中断

  在执行不得不中断的关键指令序列前，可以由CPU关闭。

中断机制接受一个地址，根据这个地址选定特定终端处理程序。这个地址称为中断向量表中的一个偏移量。

中断向量表：包含了专门的中断处理程序的内存地址。

### 直接内存访问

程序I/O（PIO）的一部分交给一个专用的存储控制器，DMA（Direct-Memory Access）控制器传输

## 内核I/O子系统

### I/O调度

通过内核管理的设备状态表。

### 缓冲

缓冲区是一块内存区域，用于保存在两个设备或在设备和应用程序之间传输的数据。

采用缓冲的三个理由：

- 处理数据流的生产者和消费者之间的速率不匹配

- 处理大小不一数据的设备

  常用于消息的分段和重组。

- 支持应用程序I/O复制语义

### 缓存

缓存cache式保存数据副本的高速内存区域。

访问缓存比访问原版更加有效

缓存是提供一个位于其他地方数据项的副本。而缓冲可以是唯一的现有副本。
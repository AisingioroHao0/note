# 死锁

## 必要条件

- 互斥
- 占有并等待
- 非抢占
- 循环等待

## 死锁预防

- 互斥

  通常无法预防，因为互斥锁不能同时被多个进程所共享

- 持有且等待

  每个进程在执行前申请并获得所有资源

  可以这样实现：要求今晨刚申请资源的系统调用在其他所有系统调用之前进行

- 无抢占

  如果一个进程持有资源并申请另一个不能立即分配的资源，允许抢占

- 循环等待

  对所有资源类型完全排序，每个进程按递增顺序申请资源

## 死锁避免

### 安全状态

### 资源分配图算法

### 银行家算法

## 死锁检测

### 每种资源类型只有单个实例

### 每种资源类型可有多个实例

### 应用检测发

## 死锁恢复

### 进程终止

- 终止所有死锁进程
- 一次终止一个进程，直到消除死锁循环为止

### 资源抢占

- 选择牺牲进程

  选择抢占资源的对象进程

- 回滚

  牺牲进程回滚到安全状态

- 饥饿

  防止同一进程的资源总是被抢占

  
# Slate

## 核心原则

CPU快速且开销低

- 防止不透明的缓存和重复状态。SLate使用以下方法（按优先级到非优先排列）
  - 轮询
  - 透明缓存
  - 带粗粒度失效的不透明缓存
- UI结构变化时优先轮询到通知。
- 放置反馈循环
- 为需要一次性操作的凌乱ad-hoc式UI做好计划。

## 轮询数据流和委托

逐帧去通过委托获取数据并显示

## 子槽

- 所有Slate控件均在子槽中存储子项。

- 子槽固定存储有效控件。默认存储SNullWidget，不带显示和交互。

## 控件类型

- 叶控件

  不带子槽。

- 面板

  子槽数量为动态的控件

- 合成控件

  子槽显示命名，数量固定的控件

## 布局

Slate布局在两个通道中完成。

1. 通道 1：**Cache Desired Size** - 相关函数为 **SWidget::CacheDesiredSize** 和 **SWidget::ComputeDesiredSize**

   自下而上的通道。

   此通道的作用是明确每个控件需要占据的控件。

   - 将叶控件基于其本质属性计算和缓存其需要的大小。

   - 合成面板控件使用特殊逻辑决定其需要的大小。

   要求每种控件实现ComputeDesiredSIze();

   缓存和遍历逻辑由Slate实现。

   Slate 将确保 ComputeDesiredSize() 在控件上被调用时其子项已计算并缓存其所需的大小。 因此这是一个自下而上的通道。

2. 通道 2：**ArrangeChildren** - 相关函数为 **SWidget::ArrangeChildren**

   自上而下的通道。

   从顶层窗口开始并要求每个窗口基于程序员所提供的约束对子项进行排列。

   # 绘制Slate：OnPaint

   


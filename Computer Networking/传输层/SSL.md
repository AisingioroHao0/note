# SSL

- C->S：客户端支持的加密算法集
- S->C：服务器的证书以及公钥
- C->S：客户端利用公钥加密自己生成的主钥并发送
- S->C：
  - 服务端利用和公钥配对的私钥解密出客户端设置的主钥
  - 利用主要生成不对称的C->S检验钥匙，C->S的加密钥，S->C检验钥，S->C加密钥
  - 利用新的S->C的密钥加密发送验证报文到客户端
- C->S：客户端发送所有握手报文的MAC
- S->C：发送所有握手报文的一个MAC